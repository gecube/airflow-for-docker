kind: Service
apiVersion: v1
metadata:
  name:  airflow
spec:
  selector:
    app: airflow
    svc: webserver
  type: NodePort
  ports:
  - name:  webserver
    port:  8080
    targetPort:  webserver
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: airflow
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: airflow
        svc: webserver
        version: 1.9.0
    spec:
      containers:
        - name: airflow
          image: z0beat/airflow:1.9.0
          args: ["airflow", "webserver"]
          ports:
            - name: webserver
              containerPort: 8080
          volumeMounts:
            - name: airflow-dags
              mountPath: /opt/airflow/dags
              readOnly: true
          env:
            - name: BACKEND
              value: sqlite
            - name: EXECUTOR
              value: SequentialExecutor
            - name: SINGLE_NODE
              value: "True"
            - name: FERNET_KEY
              value: NXtEyKwp633TUtAgdyoEonj9ufHRI7I33s3wjw3q0yU=
      volumes:
        - name: airflow-dags
          hostPath:
            path: /projects/airflow-for-docker/airflow-dags
            type: Directory